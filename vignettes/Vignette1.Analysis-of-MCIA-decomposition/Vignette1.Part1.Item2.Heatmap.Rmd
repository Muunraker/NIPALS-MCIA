---
header-includes:
   - \usepackage{amsmath}
   - \usepackage{amsfonts}
output:
  html_document: default
---

\newcommand{\mb}[1]{\mathbf{#1}}
\newcommand{\var}{\text{var}}
\newcommand{\cov}{\text{cov}}

```{r setup-V1-P1-I2, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
set.seed(42) # NIPALS starts with a random vector
```

```{r, echo=FALSE, include=FALSE}
library(nipalsMCIA)
```

<!-- Loading NCI60 data and running nipals_multiblock()
    whenever running from individual Rmarkdowns -->
```{r child="Load-Shared-Vars.Rmd", include=FALSE}
```

### Visualizing the clustering of samples by factor scores
You may also be interested in viewing how each factor contributes to each sample, 
for this you can visualize a heatmap using `global_scores_heatmap()`:
```{r, fig.align='center'}
global_scores_heatmap(mcia_results)
```
In the heatmap above, the samples have been hierarchically clustered. To further understand these clusters it is useful to add some coloring which is availble
throught the `coloring` parameter as shown below:  
```{r, fig.align='center'}
global_scores_heatmap(mcia_results, coloring = "cancerType")
```
This second heatmap allows us to see that global factor scores can successfully
encode and find differences between cancer types. For theses results it is
interesting to see that factor 1 alone can discern cancer type fairly well. 